
Di seguito le elaborazioni che falliscono sia su ambienti di jakarta che trunk,
 Le modalitÃ  principali che falliscono sono:
	1) Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
	
	2)JOB T5
	
	3) Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Cruscotto Consolidatore -> Tab 'Consolidation journals' -> Selezionare Nodo 100 - > Icona ingranaggi 'Area data processing' -> 'Esegui'
	
1)AmmortamentoAziendeElaboration
JOB T5
(CONSOLIDATION 2) Entity - Equity pick-up
 Pick-up category check
  Message = The $AMOUNT category hasn't defined the Pick-up category
  Message = The 020 category hasn't defined the Pick-up category
  Message = The 022 category hasn't defined the Pick-up category
  Message = The 024 category hasn't defined the Pick-up category
  Message = The 040 category hasn't defined the Pick-up category
  Message = The 045 category hasn't defined the Pick-up category
  Message = The 050 category hasn't defined the Pick-up category
  Message = The 055 category hasn't defined the Pick-up category
  Message = The 060 category hasn't defined the Pick-up category
  Message = The 075 category hasn't defined the Pick-up category
  Message = The 100 category hasn't defined the Pick-up category
  Message = The 104 category hasn't defined the Pick-up category
  Message = The 106 category hasn't defined the Pick-up category
  Message = The 110 category hasn't defined the Pick-up category
  Message = The 120 category hasn't defined the Pick-up category
  Message = The 124 category hasn't defined the Pick-up category
  Message = The 125 category hasn't defined the Pick-up category
  Message = The 130 category hasn't defined the Pick-up category
  Message = The 160 category hasn't defined the Pick-up category
  Message = The 170 category hasn't defined the Pick-up category
  Message = The 180 category hasn't defined the Pick-up category
  Message = The 190 category hasn't defined the Pick-up category
  Message = The 215 category hasn't defined the Pick-up category
  Message = The 300 category hasn't defined the Pick-up category
  Message = The RECODED_ category hasn't defined the Pick-up category
  
2)ConversioneElabDataProcessing
  Errore lancio di tipo a
  1a) Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 10:04:42, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 10:04:42','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091004146810169 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 10:04:43,739 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 10:04:42, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 10:04:42','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091004146810169 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor1700.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	Errore lancio elaborazione di tipo C
	
	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 10:09:12, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 10:09:12','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091009399281821 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0

	Errore in lancio da job T5
	
3)ElisioniCPIN lancio da job T4

(CONSOLIDATION 2) Group - Deferred taxes
 Tax rates check
  Message = Fiscal rate is missing for the RF02 fiscal policy, IMP1 tax
  Message = Fiscal rate is missing for the RF03 fiscal policy, IMP3 tax
  Message = Fiscal rate is missing for the USA fiscal policy, CIT tax
  Message = Fiscal rate is missing for the USA fiscal policy, INCOME_TAX tax

4)EquitizzazioneDataProcessing esito fallito da modalitÃ  1a
  1a) Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 12:59:52, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 12:59:52','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091259843130843 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 13:00:10,132 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 12:59:52, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 12:59:52','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091259843130843 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor1700.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

   EquitizzazioneDataProcessing modalitÃ  1c
   Lancio da Cruscotto consolidatore - Task Workflow
   Cruscotto Consolidatore -> Tab 'Consolidation journals' -> Selezionare Nodo 100 - > Icona ingranaggi 'Area data processing' -> 'Esegui'
   
   it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:04:29, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:04:29','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091304380821056 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 13:04:35,904 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JMSTaskMessage.setException(JMSTaskMessage.java:35)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.TaskUtil.sendMessage(TaskUtil.java:76)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.inviaMessaggioFineTaskConErrore(ElaborationTask.java:311)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:155)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:114)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Exception: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:04:29, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:04:29','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091304380821056 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 13:04:35,901 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	... 9 more
Caused by: java.lang.Exception: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:04:29, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:04:29','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091304380821056 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor1700.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	ModalitÃ  di lancio 1b T5
	
	(CONSOLIDATION 2) Entity - Equity pick-up
 Pick-up category check
  Message = The $AMOUNT category hasn't defined the Pick-up category
  Message = The 020 category hasn't defined the Pick-up category
  Message = The 022 category hasn't defined the Pick-up category
  Message = The 024 category hasn't defined the Pick-up category
  Message = The 040 category hasn't defined the Pick-up category
  Message = The 045 category hasn't defined the Pick-up category
  Message = The 050 category hasn't defined the Pick-up category
  Message = The 055 category hasn't defined the Pick-up category
  Message = The 060 category hasn't defined the Pick-up category
  Message = The 075 category hasn't defined the Pick-up category
  Message = The 100 category hasn't defined the Pick-up category
  Message = The 104 category hasn't defined the Pick-up category
  Message = The 106 category hasn't defined the Pick-up category
  Message = The 110 category hasn't defined the Pick-up category
  Message = The 120 category hasn't defined the Pick-up category
  Message = The 124 category hasn't defined the Pick-up category
  Message = The 125 category hasn't defined the Pick-up category
  Message = The 130 category hasn't defined the Pick-up category
  Message = The 160 category hasn't defined the Pick-up category
  Message = The 170 category hasn't defined the Pick-up category
  Message = The 180 category hasn't defined the Pick-up category
  Message = The 190 category hasn't defined the Pick-up category
  Message = The 215 category hasn't defined the Pick-up category
  Message = The 300 category hasn't defined the Pick-up category
  Message = The RECODED_ category hasn't defined the Pick-up category
  
5)EquityPickupConsElaboration
  Lancio modalitÃ  1a fallisce
  
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:17:38, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:17:38','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091317521128540 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 13:17:39,781 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:17:38, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:17:38','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091317521128540 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor1700.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	Errore modalitÃ  lancio 1c
	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:20:28, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:20:28','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091320674979773 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-09 13:20:30,027 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-7sfk5_172.20.85.254__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:114)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-09 13:20:28, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('09-04-2024 13:20:28','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT091320674979773 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor1700.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	Errore modalitÃ  lancio 1b JOB T5
	
5)ForzaturaConsolidamento
  Errore lancio modalitÃ  1a Esce pure una doppia finestra con i log di errore
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 07:58:22, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 07:58:22','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110758555423678 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 07:58:29,523 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 07:58:22, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 07:58:22','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110758555423678 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	Errore lancio modalitÃ  1C  esce pure una doppia finestra degli errori
	ACT_TEST2->2017->01
	1c) Lancio da Cruscotto consolidatore - Task Workflow
	Cruscotto Consolidatore -> Tab 'Consolidation journals' -> Selezionare Nodo 100 - > Icona ingranaggi 'Area data processing' -> 'Esegui'

	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:02:17, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:02:17','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110802343611125 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 08:02:20,264 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:114)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:02:17, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:02:17','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110802343611125 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more
	
   Errore anche con modalitÃ  1B JOB T5
   
6)IFSR5
  Errore modalitÃ  lancio 1a
  1a) Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:50:05, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:50:05','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110849299424844 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 08:50:07,356 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:50:05, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:50:05','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110849299424844 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

   Errore lancio modalitÃ  1C esce anche la finestra con il doppio messaggio di errore
   
   it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:53:51, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:53:51','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110853332116886 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 08:53:59,597 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:114)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 08:53:51, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 08:53:51','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT110853332116886 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

7)LookTrhoughConsElaboration
  Errore modalitÃ  lancio 1c
  ACT_TEST_3/2017TEST_3/01
  Lancio da Cruscotto consolidatore - Task Workflow
  Cruscotto Consolidatore -> Tab 'Consolidation journals' -> Selezionare Nodo 100 - > Icona ingranaggi 'Area data processing' -> 'Esegui'

  it.grupposervizi.easy.base.EasyException: Error executing elaboration: java.lang.NullPointerException [Tagetik exception information: Time 2024-04-11 12:47:28,180 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: Error executing elaboration: java.lang.NullPointerException
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:64)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.cpm.sql.equitypickupcons.EquityPickUpConsElaboration.execute(EquityPickUpConsElaboration.java:91)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more


8)MinorityDataProcessing
  Errore in modalitÃ  lancio 1a
  Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 14:46:40, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 14:46:40','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111446763206230 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 14:46:43,793 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-vb5m9_172.20.85.242__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 14:46:40, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 14:46:40','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111446763206230 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor2725.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

9)ProporzionalizzazioneDataProcessing
  Errore lancio modalitÃ  1a
   Lancio Cruscotto consolidatore - Elaborazioni di area
	Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
	selezionare tutti i nodi
	Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
	Scenario consolidamento 2017TEST2_USD periodo 01
  
  it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 15:25:02, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 15:25:02','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111524573535549 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 15:25:06,732 UTC Release 5.3.29.0 Server cmtrunk-3-wildfly-86887b9574-khltt_172.20.82.52__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 15:25:02, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 15:25:02','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111524573535549 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor10139.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

	Errore modalitÃ  lancio 1C
	
	 Lancio da Cruscotto consolidatore - Task Workflow
Cruscotto Consolidatore -> Tab 'Consolidation journals' -> Selezionare Nodo 100 - > Icona ingranaggi 'Area data processing' -> 'Esegui'

	
	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 15:33:53, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 15:33:53','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111533438047237 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-11 15:34:03,923 UTC Release 5.3.29.0 Server cmtrunk-3-wildfly-86887b9574-khltt_172.20.82.52__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyConcurrentElaboration.startTask(EasyConcurrentElaboration.java:465)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyConcurrentElaboration.startTasksGroup(EasyConcurrentElaboration.java:246)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyConcurrentElaboration.startTasksGroupAndWaitForTheEnd(EasyConcurrentElaboration.java:188)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.job.JobElaboration.executeTasks(JobElaboration.java:369)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyConcurrentElaboration.execute(EasyConcurrentElaboration.java:149)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.job.JobElaboration.execute(JobElaboration.java:210)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.workflowingrid.multiexecution.easyelaboration.WorkflowInGridMultiExecutionElaboration.createAndExecuteJob(WorkflowInGridMultiExecutionElaboration.java:338)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.workflowingrid.multiexecution.easyelaboration.WorkflowInGridMultiExecutionElaboration.execute(WorkflowInGridMultiExecutionElaboration.java:310)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-11 15:33:53, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('11-04-2024 15:33:53','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT111533438047237 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor10139.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more

   
11)ScaricoCambiDataProcessing
   Errore modalitÃ  lancio 1a
   Url: cockpit/consolidator/TGK_DEV_YYC_MODULARIZATION/ACT_TEST_2/2017TEST_2/01
selezionare tutti i nodi
Consolidation Data Processing -> Custom -> Selezionare solo Consolidation Area Data Processing
Scenario consolidamento 2017TEST2_USD periodo 01
   it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-12 14:24:00, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('12-04-2024 14:24:00','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT121423352932945 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-12 14:24:06,119 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-cqfvz_172.20.90.148__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.run(EasyElaboration.java:1102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1348)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.run(ElaborationManager.java:1063)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:105)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-12 14:24:00, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('12-04-2024 14:24:00','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT121423352932945 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor4795.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more
	
	Errore modalitÃ  lancio 1c, esce pure il doppio messaggio di errore 
	
	it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-12 14:30:22, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('12-04-2024 14:30:22','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT121430250028446 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 [Tagetik exception information: Time 2024-04-12 14:30:32,127 UTC Release 5.3.28.0 Server trunk-systemdemojkt-wildfly-85bb8d9cc7-cqfvz_172.20.90.148__not_assigned_ Database Name PG_MAN_TRUNK_DEV_YYC_2 DB Version v000 DB Update N.A. DB Patch Number 3711]
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleFailedResponse(RemoteEasyElaboration.java:250)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.handleResponseCommand(RemoteEasyElaboration.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.elaboration.remote.RemoteEasyElaboration.execute(RemoteEasyElaboration.java:80)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeRemoteSubElaborationTL(EasyElaboration.java:2308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:21)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.UserToolsUtils.concurrentExecute(UserToolsUtils.java:57)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractConcurrentExecutionStrategy.execute(AbstractConcurrentExecutionStrategy.java:14)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.processi.elabs.ScecFinalElaboration.execute(ScecFinalElaboration.java:102)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2296)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaborationTL(EasyElaboration.java:2241)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.SimpleExecutionStrategy.execute(SimpleExecutionStrategy.java:23)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.services.usertools.AbstractCachingRunnableDescriptor.execute(AbstractCachingRunnableDescriptor.java:54)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.eseguiElaborazioni(LancioElaborazioni.java:909)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.doRunElaborations(LancioElaborazioni.java:696)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.runConsElaborations(LancioElaborazioni.java:709)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.launchConsElaborationWithImpacted(LancioElaborazioni.java:525)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.LancioElaborazioni.execute(LancioElaborazioni.java:506)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.usertools.workflow.BaseWorkflowLancioElaborazioniElaboration.execute(BaseWorkflowLancioElaborazioniElaboration.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.EasyElaboration.executeSubElaboration(EasyElaboration.java:2356)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.JobDelegatingTask.executeDelegatingSubElaboration(JobDelegatingTask.java:73)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.DelegatingTask.executeTask(DelegatingTask.java:29)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.executeImpl(ElaborationTask.java:87)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationTask.execute(ElaborationTask.java:142)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.repository.ElaborationManager.runTask(ElaborationManager.java:1121)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.ElaborationMsgContentBean._call(ElaborationMsgContentBean.java:114)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.MsgContentBean.call(MsgContentBean.java:149)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.doRun(TaskRunner.java:94)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.commons.concurrent.impl.TaskRunner.run(TaskRunner.java:52)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.Throwable: it.grupposervizi.easy.base.EasyException: it.grupposervizi.easy.base.EasyException: Errore in executeQueryUpdate: org.postgresql.util.PSQLException: ERROR: null value in column "num_rettifica" of relation "dati_rett" violates not-null constraint
  Detail: Failing row contains (2017TEST_2, 01, null, EN_00, null, EN_00, null, Look Through, 1, 0, 0, 0, 0, 097, null, 0, 0, USD, null, 0, null, null, null, CONS_LOOK_THROUGH, A.VORRARO, 2024-04-12 14:30:22, 0, 0, 0, 0, null, null, 0, 0, 0, 0, 0).
Query Errata:
--------


INSERT  INTO DATI_RETT (
	COD_SCENARIO,
	COD_PERIODO,
	NUM_RETTIFICA,
	COD_AZIENDA1,
	COD_DEST21,
	COD_AZIENDA2,
	COD_DEST22,
	NOTE,
	FLAG_FILTRA_SCENARIO_CONS,
	FLAG_RIPRISTINO,
	FLAG_ESCLUDI_GPN,
	TIPO_PROP,
	TIPO_TERZI,
	TIPO_TERZI_AZIENDA1,
	TIPO_TERZI_AZIENDA2,
	TIPO_EQUITY,
	TIPO_IMPOSTE,
	TIPO_ANNULLAMENTO,
	COD_CATEGORIA,
	TIPO_GENERANTE,
	COD_GENERANTE,
	COD_GENERANTE_ORIGINARIO,
	FLAG_CAMBIO_STORICO,
	FLAG_NO_RAPPORTO,
	COD_VALUTA,
	NUM_RETTIFICA_RAGGR,
	FLAG_FINE,
	COD_AZI1_ORIGINARIA,
	COD_AZI2_ORIGINARIA,
	COD_CATEGORIA_ORIGINARIA,
	FLAG_FORZATURA_MANUALE,
	FLAG_PERIODICO,
	PROVENIENZA,
	USERUPD,
	DATEUPD
)
SELECT
	S.COD_SCENARIO_ORIGINARIO AS COD_SCENARIO,
	'01' AS COD_PERIODO,
	(
		CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 		'_'  || 		D.COD_CATEGORIA  || 		CASE WHEN D.STORNO = '0' THEN
			'_'  || 			D.COD_AZIENDA1  || 							'_'  || 		    	D.COD_DEST21
		      || 		    '_'  || 			D.COD_AZIENDA2  || 							'_'  || 		    	D.COD_DEST22
		    		ELSE
			''
		END  || 		'_'  || 		D.NUM_RETTIFICA
	) AS NUM_RETTIFICA,
    D.COD_AZIENDA1 AS COD_AZIENDA1,
	D.COD_DEST21 AS COD_DEST21,
	D.COD_AZIENDA2 AS COD_AZIENDA2,
	D.COD_DEST22 AS COD_DEST22,
	'Look Through' AS NOTE,
	0 AS FLAG_FILTRA_SCENARIO_CONS,
	MAX(DR.FLAG_RIPRISTINO) AS FLAG_RIPRISTINO,
	MAX(DR.FLAG_ESCLUDI_GPN) AS FLAG_ESCLUDI_GPN,
	'0' AS TIPO_PROP,
	'0' AS TIPO_TERZI,
	'0' AS TIPO_TERZI_AZIENDA1,
	'0' AS TIPO_TERZI_AZIENDA2,
	'0' AS TIPO_EQUITY,
	'0' AS TIPO_IMPOSTE,
	'0' AS TIPO_ANNULLAMENTO,
	D.COD_CATEGORIA AS COD_CATEGORIA,
	NULL AS TIPO_GENERANTE,
	NULL AS COD_GENERANTE,
	NULL AS COD_GENERANTE_ORIGINARIO,
	0 AS FLAG_CAMBIO_STORICO,
	0 AS FLAG_NO_RAPPORTO,
	MAX(D.COD_VALUTA) AS COD_VALUTA,
	NULL AS NUM_RETTIFICA_RAGGR,
	0 AS FLAG_FINE,
	NULL AS COD_AZI1_ORIGINARIA,
	NULL AS COD_AZI2_ORIGINARIA,
	NULL AS COD_CATEGORIA_ORIGINARIA,
	0 AS FLAG_FORZATURA_MANUALE,
	0 AS FLAG_PERIODICO,
	'CONS_LOOK_THROUGH' AS PROVENIENZA,
	'A.VORRARO' as USERUPD,
	to_timestamp ('12-04-2024 14:30:22','DD-MM-YYYY HH24:MI:SS') AS DATEUPD
FROM
	APP_LT_MOVIMENT121430250028446 D
	JOIN SCENARIO S ON
		S.COD_SCENARIO = '2017TEST2_USD'
	JOIN DATI_RETT DR ON
		DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
		DR.COD_PERIODO = '01' AND
		DR.NUM_RETTIFICA = D.NUM_RETTIFICA
WHERE
	D.IMPORTO <> 0 AND
	NOT EXISTS(
		SELECT 1
		FROM DATI_RETT DR
		WHERE
			DR.COD_SCENARIO = S.COD_SCENARIO_ORIGINARIO AND
			DR.COD_PERIODO = '01' AND
			DR.NUM_RETTIFICA = (
				CASE WHEN D.STORNO = '0' THEN 'LTO' ELSE 'LTV' END  || 				'_'  || 				D.COD_CATEGORIA  || 				CASE WHEN D.STORNO = '0' THEN
					'_'  || 					D.COD_AZIENDA1  || 											'_'  || 				    	D.COD_DEST21
				      || 				    '_'  || 					D.COD_AZIENDA2  || 											'_'  || 				    	D.COD_DEST22
				    				ELSE
					''
				END  || 				'_'  || 				D.NUM_RETTIFICA
			)
	)
GROUP BY
	S.COD_SCENARIO_ORIGINARIO,
	D.NUM_RETTIFICA,
	D.COD_AZIENDA1,
	D.COD_DEST21,
	D.COD_AZIENDA2,
	D.COD_DEST22,
	D.COD_CATEGORIA,
	D.STORNO

----------- - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0 - SQLState: 23502 - ErrorCode: 0
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//it.grupposervizi.easy.ef.consolidamento.lookthrough.LookThroughConsElaboration.executeTasks(LookThroughConsElaboration.java:93)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.FrameworkConcurrentElaboration.execute(FrameworkConcurrentElaboration.java:49)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.AbstractFrameworkElaboration.safeExecute(AbstractFrameworkElaboration.java:328)
	at jdk.internal.reflect.GeneratedMethodAccessor4795.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.callMethod(LegacyCommandExecutor.java:391)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.receivedExecuteRequest(LegacyCommandExecutor.java:308)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.getResponse(LegacyCommandExecutor.java:191)
	at deployment.cpm-trunk-jakarta.ear.gsw_ef.war//com.tagetik.akka.elaboration.LegacyCommandExecutor.run(LegacyCommandExecutor.java:160)
	... 3 more




  
